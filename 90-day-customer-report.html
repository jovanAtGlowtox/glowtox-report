<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clean 90-Day Appointments Analytics</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@2.0.1/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 50%, #581c87 100%);
            min-height: 100vh;
            color: #1f2937;
        }

        .dashboard {
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, #1e40af, #7c3aed);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            letter-spacing: -0.02em;
        }

        .header p {
            font-size: 1.25rem;
            color: #6b7280;
            font-weight: 500;
        }

        .date-range {
            font-size: 1.1rem;
            color: #9ca3af;
            margin-top: 15px;
            font-weight: 600;
        }

        .quality-badge {
            display: inline-block;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
            margin-top: 10px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--accent-color);
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .metric-value {
            font-size: 3rem;
            font-weight: 800;
            color: #111827;
            margin-bottom: 8px;
            letter-spacing: -0.02em;
        }

        .metric-label {
            font-size: 1rem;
            color: #6b7280;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 5px;
        }

        .metric-change {
            font-size: 0.875rem;
            font-weight: 600;
            padding: 4px 12px;
            border-radius: 20px;
            display: inline-block;
        }

        .metric-change.positive {
            background: #dcfce7;
            color: #166534;
        }

        .metric-change.negative {
            background: #fef2f2;
            color: #dc2626;
        }

        .charts-section {
            display: grid;
            gap: 30px;
        }

        .chart-row {
            display: grid;
            gap: 30px;
        }

        .chart-row.two-col {
            grid-template-columns: 2fr 1fr;
        }

        .chart-row.three-col {
            grid-template-columns: 1fr 1fr 1fr;
        }

        .chart-row.full {
            grid-template-columns: 1fr;
        }

        .chart-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .chart-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #111827;
            margin-bottom: 25px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .chart-container {
            position: relative;
            height: 400px;
        }

        .chart-container.tall {
            height: 500px;
        }

        .chart-container.medium {
            height: 350px;
        }

        .services-grid {
            display: grid;
            gap: 15px;
            max-height: 400px;
            overflow-y: auto;
        }

        .service-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: #f8fafc;
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
            transition: all 0.2s ease;
        }

        .service-item:hover {
            background: #e0f2fe;
            transform: translateX(5px);
        }

        .service-name {
            font-weight: 600;
            color: #374151;
            flex: 1;
        }

        .service-count {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.875rem;
            min-width: 60px;
            text-align: center;
        }

        .insight-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .insight-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-left: 4px solid #8b5cf6;
        }

        .insight-title {
            font-size: 1.125rem;
            font-weight: 700;
            color: #111827;
            margin-bottom: 10px;
        }

        .insight-text {
            color: #6b7280;
            line-height: 1.6;
        }

        /* Color scheme variables */
        .total { --accent-color: #3b82f6; }
        .first { --accent-color: #10b981; }
        .returning { --accent-color: #f59e0b; }
        .loyal { --accent-color: #8b5cf6; }
        .growth { --accent-color: #06b6d4; }
        .services { --accent-color: #ef4444; }

        @media (max-width: 1200px) {
            .chart-row.two-col, .chart-row.three-col {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-card {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="container">
            <div class="header">
                <h1>📊 Clean Appointments Analytics</h1>
                <p>90-Day Business Intelligence Dashboard</p>
                <div class="quality-badge">✨ No-Shows Excluded - Clean Data</div>
                <div class="date-range">
                    April 10, 2025 - July 08, 2025 (90 days)
                </div>
            </div>

            <div class="metrics-grid">
                <div class="metric-card total">
                    <div class="metric-value">2,268</div>
                    <div class="metric-label">Total Appointments</div>
                    <div class="metric-change positive">
                        25.2/day average
                    </div>
                </div>
                
                <div class="metric-card first">
                    <div class="metric-value">701</div>
                    <div class="metric-label">New Customers</div>
                    <div class="metric-change positive">
                        30.9% of total
                    </div>
                </div>
                
                <div class="metric-card returning">
                    <div class="metric-value">1,567</div>
                    <div class="metric-label">Returning Customers</div>
                    <div class="metric-change positive">
                        69.1% of total
                    </div>
                </div>
                
                <div class="metric-card loyal">
                    <div class="metric-value">2,053</div>
                    <div class="metric-label">Unique Customers</div>
                    <div class="metric-change positive">
                        24 loyal (3+ visits)
                    </div>
                </div>
                
                <div class="metric-card growth">
                    <div class="metric-value">-6.1%</div>
                    <div class="metric-label">Weekly Growth</div>
                    <div class="metric-change negative">
                        Last 4 weeks vs previous
                    </div>
                </div>
                
                <div class="metric-card services">
                    <div class="metric-value">38</div>
                    <div class="metric-label">Service Types</div>
                    <div class="metric-change positive">
                        100% completion rate
                    </div>
                </div>
            </div>

            <div class="charts-section">
                <div class="chart-row full">
                    <div class="chart-card">
                        <div class="chart-title">
                            📈 Daily Trend Analysis - New vs Returning Customers
                        </div>
                        <div class="chart-container tall">
                            <canvas id="dailyTrendChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="chart-row two-col">
                    <div class="chart-card">
                        <div class="chart-title">
                            📊 Weekly Patterns Comparison
                        </div>
                        <div class="chart-container">
                            <canvas id="weeklyChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">
                            🥧 Customer Distribution
                        </div>
                        <div class="chart-container">
                            <canvas id="customerPieChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="chart-row two-col">
                    <div class="chart-card">
                        <div class="chart-title">
                            🕐 Hourly Activity Patterns
                        </div>
                        <div class="chart-container">
                            <canvas id="hourlyChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">
                            📅 Monthly Performance
                        </div>
                        <div class="chart-container">
                            <canvas id="monthlyChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="chart-row two-col">
                    <div class="chart-card">
                        <div class="chart-title">
                            📊 Service Performance Trends
                        </div>
                        <div class="chart-container">
                            <canvas id="servicePerformanceChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">
                            🏆 Top Services Portfolio
                        </div>
                        <div class="services-grid">
                            <div class="service-item"><div class="service-name">Zornesfalte</div><div class="service-count">1083</div></div><div class="service-item"><div class="service-name">Stirnfalten</div><div class="service-count">989</div></div><div class="service-item"><div class="service-name">Krähenfüße</div><div class="service-count">543</div></div><div class="service-item"><div class="service-name">Kostenloses Beratungsgespräch</div><div class="service-count">195</div></div><div class="service-item"><div class="service-name">Lip Flip</div><div class="service-count">193</div></div><div class="service-item"><div class="service-name">Mona Lisa Lift</div><div class="service-count">130</div></div><div class="service-item"><div class="service-name">Brow Lift</div><div class="service-count">129</div></div><div class="service-item"><div class="service-name">Bring deinen Freund Aktion (Angebot)</div><div class="service-count">102</div></div><div class="service-item"><div class="service-name">Masseter</div><div class="service-count">85</div></div><div class="service-item"><div class="service-name">Lippenaufbau</div><div class="service-count">73</div></div><div class="service-item"><div class="service-name">Baby Glow</div><div class="service-count">54</div></div><div class="service-item"><div class="service-name">Nasolabialfalte unterspritzen</div><div class="service-count">48</div></div><div class="service-item"><div class="service-name">5-Punkte-Lifting Profhilo</div><div class="service-count">35</div></div><div class="service-item"><div class="service-name">Nasenverschmälerung</div><div class="service-count">33</div></div><div class="service-item"><div class="service-name">Deine BTX Behandlung buchen</div><div class="service-count">33</div></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="insight-cards">
                <div class="insight-card">
                    <div class="insight-title">📈 Business Growth</div>
                    <div class="insight-text">
                        Declining trend 
                        with -6.1% change in recent weeks. 
                        Average of 25.2 completed appointments per day.
                    </div>
                </div>
                
                <div class="insight-card">
                    <div class="insight-title">👥 Customer Retention</div>
                    <div class="insight-text">
                        69.1% returning customer rate indicates 
                        good 
                        customer satisfaction and loyalty. Clean data shows true engagement.
                    </div>
                </div>
                
                <div class="insight-card">
                    <div class="insight-title">🎯 Service Performance</div>
                    <div class="insight-text">
                        Top service "Zornesfalte" accounts for 47.8% of completed appointments. 
                        Service portfolio diversity: 38 different treatments with 100% completion.
                    </div>
                </div>
                
                <div class="insight-card">
                    <div class="insight-title">⚡ Operational Excellence</div>
                    <div class="insight-text">
                        Perfect completion rate with zero no-shows in this dataset. 
                        Top 2 services (Zornesfalte & Stirnfalten) account for 91.4% of appointments, 
                        showing strong service focus and customer commitment.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced color palette for better contrast and accessibility
        const colors = {
            primary: '#3b82f6',      // Blue
            primaryLight: '#93c5fd',
            success: '#10b981',      // Green  
            successLight: '#86efac',
            warning: '#f59e0b',      // Amber
            warningLight: '#fcd34d',
            purple: '#8b5cf6',       // Purple
            purpleLight: '#c4b5fd',
            cyan: '#06b6d4',         // Cyan
            cyanLight: '#67e8f9',
            rose: '#f43f5e',         // Rose
            roseLight: '#fda4af',
            gray: '#6b7280',         // Gray
            grayLight: '#d1d5db'
        };

        // Data (removed no_show fields)
        const dailyData = [{"date": "2025-04-10", "display_date": "Apr 10", "day_of_week": "Thursday", "total": 33, "first": 10, "returning": 23}, {"date": "2025-04-11", "display_date": "Apr 11", "day_of_week": "Friday", "total": 39, "first": 11, "returning": 28}, {"date": "2025-04-12", "display_date": "Apr 12", "day_of_week": "Saturday", "total": 21, "first": 5, "returning": 16}, {"date": "2025-04-13", "display_date": "Apr 13", "day_of_week": "Sunday", "total": 20, "first": 5, "returning": 15}, {"date": "2025-04-14", "display_date": "Apr 14", "day_of_week": "Monday", "total": 40, "first": 10, "returning": 30}, {"date": "2025-04-15", "display_date": "Apr 15", "day_of_week": "Tuesday", "total": 36, "first": 6, "returning": 30}, {"date": "2025-04-16", "display_date": "Apr 16", "day_of_week": "Wednesday", "total": 21, "first": 4, "returning": 17}, {"date": "2025-04-17", "display_date": "Apr 17", "day_of_week": "Thursday", "total": 19, "first": 10, "returning": 9}, {"date": "2025-04-18", "display_date": "Apr 18", "day_of_week": "Friday", "total": 11, "first": 4, "returning": 7}, {"date": "2025-04-19", "display_date": "Apr 19", "day_of_week": "Saturday", "total": 14, "first": 7, "returning": 7}, {"date": "2025-04-20", "display_date": "Apr 20", "day_of_week": "Sunday", "total": 15, "first": 6, "returning": 9}, {"date": "2025-04-21", "display_date": "Apr 21", "day_of_week": "Monday", "total": 18, "first": 3, "returning": 15}, {"date": "2025-04-22", "display_date": "Apr 22", "day_of_week": "Tuesday", "total": 26, "first": 8, "returning": 18}, {"date": "2025-04-23", "display_date": "Apr 23", "day_of_week": "Wednesday", "total": 34, "first": 6, "returning": 28}, {"date": "2025-04-24", "display_date": "Apr 24", "day_of_week": "Thursday", "total": 23, "first": 4, "returning": 19}, {"date": "2025-04-25", "display_date": "Apr 25", "day_of_week": "Friday", "total": 32, "first": 10, "returning": 22}, {"date": "2025-04-26", "display_date": "Apr 26", "day_of_week": "Saturday", "total": 24, "first": 5, "returning": 19}, {"date": "2025-04-27", "display_date": "Apr 27", "day_of_week": "Sunday", "total": 17, "first": 5, "returning": 12}, {"date": "2025-04-28", "display_date": "Apr 28", "day_of_week": "Monday", "total": 29, "first": 6, "returning": 23}, {"date": "2025-04-29", "display_date": "Apr 29", "day_of_week": "Tuesday", "total": 22, "first": 8, "returning": 14}, {"date": "2025-04-30", "display_date": "Apr 30", "day_of_week": "Wednesday", "total": 21, "first": 7, "returning": 14}, {"date": "2025-05-01", "display_date": "May 01", "day_of_week": "Thursday", "total": 14, "first": 2, "returning": 12}, {"date": "2025-05-02", "display_date": "May 02", "day_of_week": "Friday", "total": 21, "first": 9, "returning": 12}, {"date": "2025-05-03", "display_date": "May 03", "day_of_week": "Saturday", "total": 15, "first": 4, "returning": 11}, {"date": "2025-05-04", "display_date": "May 04", "day_of_week": "Sunday", "total": 11, "first": 2, "returning": 9}, {"date": "2025-05-05", "display_date": "May 05", "day_of_week": "Monday", "total": 26, "first": 6, "returning": 20}, {"date": "2025-05-06", "display_date": "May 06", "day_of_week": "Tuesday", "total": 38, "first": 12, "returning": 26}, {"date": "2025-05-07", "display_date": "May 07", "day_of_week": "Wednesday", "total": 32, "first": 6, "returning": 26}, {"date": "2025-05-08", "display_date": "May 08", "day_of_week": "Thursday", "total": 39, "first": 11, "returning": 28}, {"date": "2025-05-09", "display_date": "May 09", "day_of_week": "Friday", "total": 30, "first": 15, "returning": 15}, {"date": "2025-05-10", "display_date": "May 10", "day_of_week": "Saturday", "total": 13, "first": 5, "returning": 8}, {"date": "2025-05-11", "display_date": "May 11", "day_of_week": "Sunday", "total": 11, "first": 5, "returning": 6}, {"date": "2025-05-12", "display_date": "May 12", "day_of_week": "Monday", "total": 34, "first": 10, "returning": 24}, {"date": "2025-05-13", "display_date": "May 13", "day_of_week": "Tuesday", "total": 32, "first": 7, "returning": 25}, {"date": "2025-05-14", "display_date": "May 14", "day_of_week": "Wednesday", "total": 34, "first": 10, "returning": 24}, {"date": "2025-05-15", "display_date": "May 15", "day_of_week": "Thursday", "total": 29, "first": 9, "returning": 20}, {"date": "2025-05-16", "display_date": "May 16", "day_of_week": "Friday", "total": 31, "first": 9, "returning": 22}, {"date": "2025-05-17", "display_date": "May 17", "day_of_week": "Saturday", "total": 14, "first": 4, "returning": 10}, {"date": "2025-05-18", "display_date": "May 18", "day_of_week": "Sunday", "total": 21, "first": 3, "returning": 18}, {"date": "2025-05-19", "display_date": "May 19", "day_of_week": "Monday", "total": 27, "first": 6, "returning": 21}, {"date": "2025-05-20", "display_date": "May 20", "day_of_week": "Tuesday", "total": 36, "first": 10, "returning": 26}, {"date": "2025-05-21", "display_date": "May 21", "day_of_week": "Wednesday", "total": 26, "first": 9, "returning": 17}, {"date": "2025-05-22", "display_date": "May 22", "day_of_week": "Thursday", "total": 32, "first": 8, "returning": 24}, {"date": "2025-05-23", "display_date": "May 23", "day_of_week": "Friday", "total": 32, "first": 10, "returning": 22}, {"date": "2025-05-24", "display_date": "May 24", "day_of_week": "Saturday", "total": 17, "first": 5, "returning": 12}, {"date": "2025-05-25", "display_date": "May 25", "day_of_week": "Sunday", "total": 17, "first": 7, "returning": 10}, {"date": "2025-05-26", "display_date": "May 26", "day_of_week": "Monday", "total": 25, "first": 6, "returning": 19}, {"date": "2025-05-27", "display_date": "May 27", "day_of_week": "Tuesday", "total": 34, "first": 16, "returning": 18}, {"date": "2025-05-28", "display_date": "May 28", "day_of_week": "Wednesday", "total": 21, "first": 8, "returning": 13}, {"date": "2025-05-29", "display_date": "May 29", "day_of_week": "Thursday", "total": 15, "first": 9, "returning": 6}, {"date": "2025-05-30", "display_date": "May 30", "day_of_week": "Friday", "total": 24, "first": 7, "returning": 17}, {"date": "2025-05-31", "display_date": "May 31", "day_of_week": "Saturday", "total": 14, "first": 5, "returning": 9}, {"date": "2025-06-01", "display_date": "Jun 01", "day_of_week": "Sunday", "total": 10, "first": 1, "returning": 9}, {"date": "2025-06-02", "display_date": "Jun 02", "day_of_week": "Monday", "total": 41, "first": 10, "returning": 31}, {"date": "2025-06-03", "display_date": "Jun 03", "day_of_week": "Tuesday", "total": 41, "first": 11, "returning": 30}, {"date": "2025-06-04", "display_date": "Jun 04", "day_of_week": "Wednesday", "total": 23, "first": 5, "returning": 18}, {"date": "2025-06-05", "display_date": "Jun 05", "day_of_week": "Thursday", "total": 30, "first": 7, "returning": 23}, {"date": "2025-06-06", "display_date": "Jun 06", "day_of_week": "Friday", "total": 26, "first": 10, "returning": 16}, {"date": "2025-06-07", "display_date": "Jun 07", "day_of_week": "Saturday", "total": 12, "first": 5, "returning": 7}, {"date": "2025-06-08", "display_date": "Jun 08", "day_of_week": "Sunday", "total": 19, "first": 8, "returning": 11}, {"date": "2025-06-09", "display_date": "Jun 09", "day_of_week": "Monday", "total": 16, "first": 7, "returning": 9}, {"date": "2025-06-10", "display_date": "Jun 10", "day_of_week": "Tuesday", "total": 26, "first": 11, "returning": 15}, {"date": "2025-06-11", "display_date": "Jun 11", "day_of_week": "Wednesday", "total": 31, "first": 7, "returning": 24}, {"date": "2025-06-12", "display_date": "Jun 12", "day_of_week": "Thursday", "total": 25, "first": 7, "returning": 18}, {"date": "2025-06-13", "display_date": "Jun 13", "day_of_week": "Friday", "total": 25, "first": 10, "returning": 15}, {"date": "2025-06-14", "display_date": "Jun 14", "day_of_week": "Saturday", "total": 3, "first": 3, "returning": 0}, {"date": "2025-06-15", "display_date": "Jun 15", "day_of_week": "Sunday", "total": 19, "first": 10, "returning": 9}, {"date": "2025-06-16", "display_date": "Jun 16", "day_of_week": "Monday", "total": 33, "first": 11, "returning": 22}, {"date": "2025-06-17", "display_date": "Jun 17", "day_of_week": "Tuesday", "total": 36, "first": 9, "returning": 27}, {"date": "2025-06-18", "display_date": "Jun 18", "day_of_week": "Wednesday", "total": 13, "first": 4, "returning": 9}, {"date": "2025-06-19", "display_date": "Jun 19", "day_of_week": "Thursday", "total": 13, "first": 6, "returning": 7}, {"date": "2025-06-20", "display_date": "Jun 20", "day_of_week": "Friday", "total": 30, "first": 11, "returning": 19}, {"date": "2025-06-21", "display_date": "Jun 21", "day_of_week": "Saturday", "total": 14, "first": 4, "returning": 10}, {"date": "2025-06-22", "display_date": "Jun 22", "day_of_week": "Sunday", "total": 19, "first": 11, "returning": 8}, {"date": "2025-06-23", "display_date": "Jun 23", "day_of_week": "Monday", "total": 30, "first": 8, "returning": 22}, {"date": "2025-06-24", "display_date": "Jun 24", "day_of_week": "Tuesday", "total": 33, "first": 15, "returning": 18}, {"date": "2025-06-25", "display_date": "Jun 25", "day_of_week": "Wednesday", "total": 35, "first": 9, "returning": 26}, {"date": "2025-06-26", "display_date": "Jun 26", "day_of_week": "Thursday", "total": 36, "first": 15, "returning": 21}, {"date": "2025-06-27", "display_date": "Jun 27", "day_of_week": "Friday", "total": 23, "first": 7, "returning": 16}, {"date": "2025-06-28", "display_date": "Jun 28", "day_of_week": "Saturday", "total": 13, "first": 6, "returning": 7}, {"date": "2025-06-29", "display_date": "Jun 29", "day_of_week": "Sunday", "total": 12, "first": 6, "returning": 6}, {"date": "2025-06-30", "display_date": "Jun 30", "day_of_week": "Monday", "total": 34, "first": 6, "returning": 28}, {"date": "2025-07-01", "display_date": "Jul 01", "day_of_week": "Tuesday", "total": 33, "first": 8, "returning": 25}, {"date": "2025-07-02", "display_date": "Jul 02", "day_of_week": "Wednesday", "total": 32, "first": 10, "returning": 22}, {"date": "2025-07-03", "display_date": "Jul 03", "day_of_week": "Thursday", "total": 38, "first": 14, "returning": 24}, {"date": "2025-07-04", "display_date": "Jul 04", "day_of_week": "Friday", "total": 27, "first": 6, "returning": 21}, {"date": "2025-07-05", "display_date": "Jul 05", "day_of_week": "Saturday", "total": 14, "first": 5, "returning": 9}, {"date": "2025-07-06", "display_date": "Jul 06", "day_of_week": "Sunday", "total": 10, "first": 3, "returning": 7}, {"date": "2025-07-07", "display_date": "Jul 07", "day_of_week": "Monday", "total": 51, "first": 19, "returning": 32}, {"date": "2025-07-08", "display_date": "Jul 08", "day_of_week": "Tuesday", "total": 62, "first": 21, "returning": 41}];
        const weeklyData = [{"day": "Monday", "total": 404, "first": 108, "returning": 296}, {"day": "Tuesday", "total": 455, "first": 142, "returning": 313}, {"day": "Wednesday", "total": 323, "first": 85, "returning": 238}, {"day": "Thursday", "total": 346, "first": 112, "returning": 234}, {"day": "Friday", "total": 351, "first": 119, "returning": 232}, {"day": "Saturday", "total": 188, "first": 63, "returning": 125}, {"day": "Sunday", "total": 201, "first": 72, "returning": 129}];
        const monthlyData = [{"month": "Apr 2025", "total": 515, "first": 140, "returning": 375}, {"month": "May 2025", "total": 765, "first": 235, "returning": 530}, {"month": "Jun 2025", "total": 721, "first": 240, "returning": 481}, {"month": "Jul 2025", "total": 267, "first": 86, "returning": 181}];
        const hourlyData = [{"hour": "00:00", "total": 40, "first": 18, "returning": 22}, {"hour": "01:00", "total": 19, "first": 8, "returning": 11}, {"hour": "02:00", "total": 2, "first": 1, "returning": 1}, {"hour": "03:00", "total": 3, "first": 0, "returning": 3}, {"hour": "04:00", "total": 7, "first": 2, "returning": 5}, {"hour": "05:00", "total": 6, "first": 1, "returning": 5}, {"hour": "06:00", "total": 16, "first": 1, "returning": 15}, {"hour": "07:00", "total": 52, "first": 14, "returning": 38}, {"hour": "08:00", "total": 84, "first": 29, "returning": 55}, {"hour": "09:00", "total": 93, "first": 28, "returning": 65}, {"hour": "10:00", "total": 203, "first": 51, "returning": 152}, {"hour": "11:00", "total": 170, "first": 57, "returning": 113}, {"hour": "12:00", "total": 169, "first": 49, "returning": 120}, {"hour": "13:00", "total": 149, "first": 47, "returning": 102}, {"hour": "14:00", "total": 160, "first": 51, "returning": 109}, {"hour": "15:00", "total": 166, "first": 59, "returning": 107}, {"hour": "16:00", "total": 161, "first": 47, "returning": 114}, {"hour": "17:00", "total": 161, "first": 46, "returning": 115}, {"hour": "18:00", "total": 148, "first": 38, "returning": 110}, {"hour": "19:00", "total": 121, "first": 34, "returning": 87}, {"hour": "20:00", "total": 103, "first": 34, "returning": 69}, {"hour": "21:00", "total": 100, "first": 36, "returning": 64}, {"hour": "22:00", "total": 73, "first": 27, "returning": 46}, {"hour": "23:00", "total": 62, "first": 23, "returning": 39}];
        
        const customerStats = {
            first: 701,
            returning: 1567,
            total: 2268,
            unique: 2053,
            loyal: 24,
            occasional: 164,
            oneTime: 1865
        };

        // Service performance data
        const servicePerformanceData = [{"service": "Zornesfalte", "data": [60, 66, 87, 63, 92, 97, 84, 73, 84, 73, 84, 92, 83, 45]}, {"service": "Stirnfalten", "data": [50, 59, 73, 64, 73, 87, 81, 58, 79, 70, 66, 85, 94, 50]}, {"service": "Kr\u00e4henf\u00fc\u00dfe", "data": [26, 41, 40, 29, 42, 42, 39, 43, 49, 30, 41, 53, 45, 23]}, {"service": "Kostenloses Beratungsgespr\u00e4ch", "data": [6, 9, 9, 21, 12, 13, 15, 16, 18, 12, 19, 10, 17, 18]}, {"service": "Lip Flip", "data": [8, 18, 14, 15, 13, 17, 15, 14, 13, 10, 19, 12, 17, 8]}];
        const weekLabels = ["Week 1", "Week 2", "Week 3", "Week 4", "Week 5", "Week 6", "Week 7", "Week 8", "Week 9", "Week 10", "Week 11", "Week 12", "Week 13", "Week 14"];

        // Chart defaults
        Chart.defaults.font.family = "'Inter', sans-serif";
        Chart.defaults.font.size = 12;
        Chart.defaults.color = '#6b7280';

        // Daily trend chart with dual axis
        function createDailyTrendChart() {
            const ctx = document.getElementById('dailyTrendChart').getContext('2d');
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dailyData.map(d => d.display_date),
                    datasets: [
                        {
                            label: 'New Customers',
                            data: dailyData.map(d => d.first),
                            borderColor: colors.success,
                            backgroundColor: colors.successLight + '40',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 2,
                            pointHoverRadius: 6
                        },
                        {
                            label: 'Returning Customers',
                            data: dailyData.map(d => d.returning),
                            borderColor: colors.warning,
                            backgroundColor: colors.warningLight + '40',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 2,
                            pointHoverRadius: 6
                        },
                        {
                            label: 'Total Appointments',
                            data: dailyData.map(d => d.total),
                            borderColor: colors.primary,
                            backgroundColor: 'transparent',
                            borderWidth: 4,
                            fill: false,
                            tension: 0.4,
                            pointRadius: 3,
                            pointHoverRadius: 8,
                            borderDash: [5, 5]
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: { size: 14, weight: '600' }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(17, 24, 39, 0.95)',
                            titleColor: '#f3f4f6',
                            bodyColor: '#f3f4f6',
                            borderColor: colors.primary,
                            borderWidth: 1,
                            cornerRadius: 12,
                            padding: 12
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            ticks: {
                                maxTicksLimit: 15,
                                font: { weight: '600' }
                            },
                            grid: { display: false }
                        },
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.05)' },
                            ticks: { font: { weight: '600' } }
                        }
                    }
                }
            });
        }

        // Weekly pattern chart
        function createWeeklyChart() {
            const ctx = document.getElementById('weeklyChart').getContext('2d');
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: weeklyData.map(d => d.day.slice(0,3)),
                    datasets: [
                        {
                            label: 'New Customers',
                            data: weeklyData.map(d => d.first),
                            backgroundColor: colors.success,
                            borderColor: colors.success,
                            borderWidth: 2,
                            borderRadius: 8
                        },
                        {
                            label: 'Returning Customers',
                            data: weeklyData.map(d => d.returning),
                            backgroundColor: colors.warning,
                            borderColor: colors.warning,
                            borderWidth: 2,
                            borderRadius: 8
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                padding: 15,
                                usePointStyle: true,
                                font: { size: 12, weight: '600' }
                            }
                        }
                    },
                    scales: {
                        x: { grid: { display: false } },
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.05)' }
                        }
                    }
                }
            });
        }

        // Customer distribution pie chart
        function createCustomerPieChart() {
            const ctx = document.getElementById('customerPieChart').getContext('2d');
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['New Customers', 'Returning Customers'],
                    datasets: [{
                        data: [customerStats.first, customerStats.returning],
                        backgroundColor: [colors.success, colors.warning],
                        borderColor: [colors.success, colors.warning],
                        borderWidth: 3,
                        hoverOffset: 15
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: { size: 12, weight: '600' }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const percentage = ((context.parsed / customerStats.total) * 100).toFixed(1);
                                    return `${context.label}: ${context.parsed.toLocaleString()} (${percentage}%)`;
                                }
                            }
                        }
                    },
                    cutout: '60%'
                }
            });
        }

        // Hourly activity chart
        function createHourlyChart() {
            const ctx = document.getElementById('hourlyChart').getContext('2d');
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: hourlyData.map(d => d.hour),
                    datasets: [
                        {
                            label: 'New Customers',
                            data: hourlyData.map(d => d.first),
                            borderColor: colors.success,
                            backgroundColor: colors.successLight + '30',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Returning Customers',
                            data: hourlyData.map(d => d.returning),
                            borderColor: colors.warning,
                            backgroundColor: colors.warningLight + '30',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                padding: 15,
                                usePointStyle: true,
                                font: { size: 12, weight: '600' }
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: { maxTicksLimit: 12 },
                            grid: { display: false }
                        },
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.05)' }
                        }
                    }
                }
            });
        }

        // Monthly performance chart
        function createMonthlyChart() {
            const ctx = document.getElementById('monthlyChart').getContext('2d');
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: monthlyData.map(d => d.month),
                    datasets: [
                        {
                            label: 'New Customers',
                            data: monthlyData.map(d => d.first),
                            backgroundColor: colors.success,
                            borderRadius: 8
                        },
                        {
                            label: 'Returning Customers',
                            data: monthlyData.map(d => d.returning),
                            backgroundColor: colors.warning,
                            borderRadius: 8
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                padding: 15,
                                usePointStyle: true,
                                font: { size: 12, weight: '600' }
                            }
                        }
                    },
                    scales: {
                        x: { grid: { display: false } },
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.05)' }
                        }
                    }
                }
            });
        }

        // Service performance trends chart
        function createServicePerformanceChart() {
            const ctx = document.getElementById('servicePerformanceChart').getContext('2d');
            
            // Enhanced color palette for services
            const serviceColors = [
                colors.primary,    // Blue
                colors.success,    // Green
                colors.warning,    // Amber
                colors.purple,     // Purple
                colors.cyan       // Cyan
            ];
            
            const datasets = servicePerformanceData.map((service, index) => ({
                label: service.service,
                data: service.data,
                borderColor: serviceColors[index % serviceColors.length],
                backgroundColor: serviceColors[index % serviceColors.length] + '20',
                borderWidth: 3,
                fill: false,
                tension: 0.4,
                pointRadius: 4,
                pointHoverRadius: 7,
                pointBackgroundColor: serviceColors[index % serviceColors.length],
                pointBorderColor: '#ffffff',
                pointBorderWidth: 2
            }));

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: weekLabels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                padding: 15,
                                usePointStyle: true,
                                font: { size: 11, weight: '600' },
                                generateLabels: function(chart) {
                                    const original = Chart.defaults.plugins.legend.labels.generateLabels;
                                    const labels = original.call(this, chart);
                                    labels.forEach(label => {
                                        label.text = label.text.length > 15 ? 
                                            label.text.substring(0, 12) + '...' : label.text;
                                    });
                                    return labels;
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(17, 24, 39, 0.95)',
                            titleColor: '#f3f4f6',
                            bodyColor: '#f3f4f6',
                            borderColor: colors.primary,
                            borderWidth: 1,
                            cornerRadius: 12,
                            padding: 12,
                            callbacks: {
                                title: function(context) {
                                    return context[0].label;
                                },
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.parsed.y} appointments`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { display: false },
                            ticks: {
                                font: { weight: '600' },
                                maxTicksLimit: 8
                            }
                        },
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 0, 0, 0.05)' },
                            ticks: {
                                font: { weight: '600' },
                                callback: function(value) {
                                    return value + ' appts';
                                }
                            }
                        }
                    }
                }
            });
        }

        // Initialize all charts
        window.addEventListener('load', function() {
            createDailyTrendChart();
            createWeeklyChart();
            createCustomerPieChart();
            createHourlyChart();
            createMonthlyChart();
            createServicePerformanceChart();
        });
    </script>
</body>
</html>
